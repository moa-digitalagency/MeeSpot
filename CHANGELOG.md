# Changelog - MatchSpot

Ce fichier documente toutes les modifications, corrections et am√©liorations apport√©es au projet MatchSpot.

## Instructions
**Important**: Ce fichier doit √™tre mis √† jour √† chaque modification importante du code, correction de bug, ou ajout de fonctionnalit√©.

---

## [11 Octobre 2025 - 21:15 UTC] - Corrections Forfaits et Messages de Confirmation

### üêõ Corrections de bugs

- **Correction des descriptions de forfaits hebdomadaires**
  - Probl√®me: Les forfaits Silver et Gold affichaient "par jour" alors qu'ils sont hebdomadaires
  - Solution: 
    - Mise √† jour des descriptions en base de donn√©es: "Silver - 3 rooms/semaine (cycle hebdomadaire)" et "Gold - 7 rooms/semaine (cycle hebdomadaire)"
    - Ajout de logique JavaScript pour afficher "par semaine" pour les forfaits Silver et Gold au lieu de "par jour"
  - Fichiers modifi√©s: 
    - `backend/__init__.py` (lignes 107-109) - Descriptions initiales corrig√©es
    - `static/pages/establishment.html` (lignes 984-1008) - Logique d'affichage "par semaine"
    - `static/pages/admin.html` (lignes 709-737) - Logique d'affichage "par semaine"
  - Base de donn√©es mise √† jour via SQL

- **Clarification du forfait One-Shot**
  - Probl√®me: La description ne mentionnait pas clairement qu'il s'agit d'une room unique sans cycle
  - Solution: Description mise √† jour en "One-Shot - 1 room unique (24h, pas de cycle)"
  - Fichier modifi√©: `backend/__init__.py` (ligne 107)

- **Correction du message de confirmation d'achat One-Shot**
  - Probl√®me: Le message "One-Shot achet√© avec succ√®s! Vous pouvez maintenant cr√©er votre room" ne mentionnait pas que c'est une demande n√©cessitant validation admin
  - Solution: Message chang√© en "Demande de One-Shot envoy√©e! L'administrateur examinera votre demande bient√¥t."
  - Fichier modifi√©: `static/pages/establishment.html` (ligne 1172)

### üìã Fichiers Modifi√©s

- `backend/__init__.py` - Corrections des descriptions des forfaits √©tablissements
- `static/pages/establishment.html` - Affichage "par semaine" + message de confirmation corrig√©
- `static/pages/admin.html` - Affichage "par semaine" pour les forfaits hebdomadaires
- Base de donn√©es - Mise √† jour des descriptions via SQL

### ‚úÖ Tests Effectu√©s

- ‚úÖ Les forfaits Silver et Gold affichent maintenant "par semaine" correctement
- ‚úÖ Le forfait One-Shot affiche "par jour" (1 room unique)
- ‚úÖ Le message de confirmation One-Shot mentionne la validation admin
- ‚úÖ L'API de chargement des forfaits fonctionne correctement
- ‚úÖ Application red√©marr√©e sans erreur

### üîß Correction post-r√©vision architecte

- **Fix affichage incorrect des quotas hebdomadaires**
  - Probl√®me identifi√©: La logique affichait "1 room par semaine" au lieu de "3 rooms par semaine" (Silver) et "7 rooms par semaine" (Gold)
  - Solution: Impl√©mentation d'une logique d'affichage bas√©e sur le nom du plan avec les valeurs correctes hardcod√©es
    - Silver: "3 rooms par semaine"
    - Gold: "7 rooms par semaine"
    - One-Shot: "1 room unique (24h)"
  - Fichiers modifi√©s: 
    - `static/pages/establishment.html` (lignes 984-1017)
    - `static/pages/admin.html` (lignes 709-746)

### üìù Notes techniques

- Les forfaits hebdomadaires (Silver, Gold) utilisent toujours `rooms_per_day=1` en base de donn√©es mais sont pr√©sent√©s comme hebdomadaires
- La logique d'affichage d√©termine le texte √† afficher bas√© sur le nom du plan (hardcod√© pour clart√©)
- √Ä long terme, consid√©rer l'ajout d'un champ `rooms_per_week` en backend pour √©viter le hardcoding
- Le syst√®me de validation par admin fonctionne pour tous les types d'achat de forfaits

---

## [11 Octobre 2025 - 20:00 UTC] - Am√©liorations Profil √âtablissement et Gestion Compte

### ‚ú® Nouvelles Fonctionnalit√©s

- **Affichage du nom du contact dans le profil √©tablissement**
  - Le nom de la personne de contact (contact_name) est maintenant affich√© dans le profil
  - Ajout d'une section d√©di√©e "üë§ Nom du contact" dans la carte de profil
  - Fichier modifi√©: `static/pages/establishment.html` (lignes 141-156)

- **Param√®tres de profil complets pour √©tablissements**
  - **Informations de l'√©tablissement**:
    - Nom de l'√©tablissement (modifiable)
    - Description (modifiable)
    - Adresse (modifiable)
    - T√©l√©phone de contact (modifiable)
    - Photo par d√©faut (modifiable)
  - **Informations du compte**:
    - Nom du contact (modifiable)
    - Nom d'utilisateur (modifiable, v√©rification d'unicit√©)
    - Email (affichage seul, non modifiable)
  - Note: Le changement de mot de passe n√©cessite une route d√©di√©e s√©curis√©e (/api/profile/password)
  - Fichiers modifi√©s: 
    - `static/pages/establishment.html` (lignes 406-461)
    - `backend/routes/profile.py` (route `/api/profile/update-account`, lignes 149-169)

- **Route de mise √† jour du compte utilisateur**
  - Nouvelle route PUT `/api/profile/update-account` pour mettre √† jour nom et username
  - Validation de l'unicit√© du username avant modification
  - S√©curit√©: Le mot de passe ne peut PAS √™tre modifi√© via cette route (utiliser /api/profile/password)
  - Fichier ajout√©: `backend/routes/profile.py` (lignes 149-169)

### üêõ Corrections de bugs

- **Fix de la route de demande de subscription**
  - Probl√®me: Le frontend envoyait les demandes √† `/api/subscriptions` mais la route √©tait `/api/subscriptions/request`
  - Solution: Ajout de la route `/api/subscriptions` (POST) en plus de `/api/subscriptions/request`
  - Les deux endpoints fonctionnent maintenant de mani√®re identique
  - Fichiers modifi√©s: `backend/routes/subscriptions.py` (lignes 21-22)

- **Fix du champ payment_type manquant dans les demandes de subscription**
  - Probl√®me: Le champ `payment_type` n'√©tait pas d√©fini lors de la cr√©ation d'une demande
  - Solution: D√©termination automatique du type de paiement bas√© sur le tier de subscription
    - 'one-shot' ‚Üí payment_type: 'one_shot'
    - Autres plans ‚Üí payment_type: 'recurring'
  - Impact: L'approbation des demandes fonctionne maintenant correctement
  - Fichier modifi√©: `backend/routes/subscriptions.py` (lignes 40-48)

### üîß Am√©liorations

- **Gestion am√©lior√©e des donn√©es utilisateur**
  - Stockage de userData dans une variable globale JavaScript pour acc√®s facile
  - Affichage coh√©rent des informations du contact partout dans l'interface
  - Fichier modifi√©: `static/pages/establishment.html` (lignes 471-490)

- **Mise √† jour en parall√®le des donn√©es**
  - Les param√®tres d'√©tablissement et de compte utilisateur sont mis √† jour simultan√©ment
  - Utilisation de Promise.all pour optimiser les requ√™tes HTTP
  - Synchronisation du localStorage apr√®s mise √† jour r√©ussie
  - Fichier modifi√©: `static/pages/establishment.html` (lignes 1120-1160)

### üìã Fichiers Modifi√©s

- `static/pages/establishment.html` - Ajout nom du contact, param√®tres complets, gestion userData
- `backend/routes/profile.py` - Route update-account pour mise √† jour nom/username/password
- `backend/routes/subscriptions.py` - Fix routes et ajout payment_type automatique

### ‚úÖ Tests Recommand√©s

Une fois l'ENCRYPTION_KEY configur√©e dans les secrets:
- [ ] V√©rifier l'affichage du nom du contact dans le profil √©tablissement
- [ ] Tester la modification de toutes les informations dans les param√®tres
- [ ] V√©rifier le changement de username (avec v√©rification d'unicit√©)
- [ ] Tester le changement de mot de passe
- [ ] Cr√©er une demande de forfait et v√©rifier qu'elle appara√Æt c√¥t√© admin
- [ ] Approuver une demande et v√©rifier la mise √† jour du plan

### ‚ö†Ô∏è Note Importante

L'application n√©cessite la cl√© `ENCRYPTION_KEY` dans les secrets Replit pour d√©marrer.
Cette cl√© est utilis√©e pour chiffrer les donn√©es sensibles (emails, noms, etc.) dans la base de donn√©es.

---

## [11 Octobre 2025 - 15:00 UTC] - Am√©liorations Inscription √âtablissement et Achat Plans

### ‚ú® Nouvelles Fonctionnalit√©s
- **Ajout du champ t√©l√©phone du contact pour les √©tablissements**
  - Nouveau champ `contact_phone` dans le mod√®le `Establishment`
  - Champ ajout√© au formulaire d'inscription et aux param√®tres du profil
  - Fichiers modifi√©s: `backend/models/establishment.py`, `backend/routes/auth.py`, `backend/routes/establishments.py`

- **Route d'achat direct de plans pour √©tablissements**
  - Nouvelle route POST `/api/establishments/me/buy-plan` pour acheter un plan directement
  - Support pour l'achat de plans one-shot, silver et gold
  - R√©initialisation automatique des compteurs selon le type de plan
  - Fichier modifi√©: `backend/routes/establishments.py` (lignes 362-399)

### üêõ Corrections de bugs
- **Fix erreur "Erreur de connexion" lors de l'achat de plan one-shot**
  - Probl√®me: La fonction `buyOneShot()` appelait `/api/subscriptions` (route de demande admin) au lieu d'une route d'achat direct
  - Solution: Redirection vers `/api/establishments/me/buy-plan` avec `plan_name: 'one-shot'`
  - Fichier modifi√©: `static/pages/establishment.html` (lignes 1084-1090)

- **Fix affichage vide du plan apr√®s inscription**
  - Probl√®me: Le champ `subscription_plan` vide s'affichait comme vide dans l'interface
  - Solution: Logique de pr√©sentation d√©plac√©e c√¥t√© frontend pour afficher "Pas de forfait actif" quand le plan est null/empty
  - L'API retourne maintenant la valeur brute (null/empty) pour pr√©server la logique de d√©tection c√¥t√© client
  - Fichiers modifi√©s: `static/pages/establishment.html` (lignes 532-533, 575-576)

### üóÑÔ∏è Migration de Base de Donn√©es
- **Ajout de la colonne contact_phone**
  - Migration automatique ajout√©e dans `backend/utils/db_migration.py`
  - Colonne: `contact_phone VARCHAR(20)` (nullable)
  - Ex√©cution automatique au d√©marrage de l'application
  - Fichier modifi√©: `backend/utils/db_migration.py` (ligne 33)

### üìã Fichiers Modifi√©s
- `backend/models/establishment.py` - Ajout champ contact_phone et affichage "Pas de forfait actif"
- `backend/routes/auth.py` - Support contact_phone dans l'inscription
- `backend/routes/establishments.py` - Route d'achat de plan + support contact_phone
- `backend/utils/db_migration.py` - Migration contact_phone
- `static/pages/establishment.html` - Correction fonction buyOneShot()

### üì¶ Commandes de D√©ploiement VPS

#### Mise √† jour du code depuis GitHub
```bash
# Se connecter au VPS via SSH
ssh user@votre-serveur.com

# Aller dans le r√©pertoire du projet
cd /chemin/vers/matchspot

# Sauvegarder la configuration actuelle
cp .env .env.backup

# R√©cup√©rer les derni√®res modifications
git pull origin main

# Installer/mettre √† jour les d√©pendances si n√©cessaire
pip install -r requirements.txt
```

#### Migration de la Base de Donn√©es
```bash
# La migration s'ex√©cute automatiquement au d√©marrage de l'application
# Aucune commande SQL manuelle requise

# Red√©marrer l'application pour appliquer les changements
sudo systemctl restart matchspot
# OU si vous utilisez gunicorn directement
pkill -HUP gunicorn
```

#### V√©rification apr√®s d√©ploiement
```bash
# V√©rifier les logs pour confirmer la migration
tail -f /var/log/matchspot/error.log
# Vous devriez voir: "‚úì Column contact_phone added to establishments"

# V√©rifier que l'application r√©pond
curl http://localhost:5000/

# V√©rifier le statut du service
sudo systemctl status matchspot

# Tester l'achat de plan one-shot via l'interface √©tablissement
# V√©rifier qu'il n'y a plus d'erreur "Erreur de connexion"
```

### ‚úÖ Tests Effectu√©s
- ‚úÖ Migration de la colonne contact_phone ex√©cut√©e avec succ√®s
- ‚úÖ Inscription d'√©tablissement avec contact_phone fonctionne
- ‚úÖ Achat de plan one-shot fonctionne sans erreur
- ‚úÖ Affichage "Pas de forfait actif" au lieu de vide
- ‚úÖ Application red√©marr√©e sans erreur

---

## [11 Octobre 2025 - 09:00 UTC] - Corrections Profil √âtablissement et Limites Forfaits

### üêõ Corrections de bugs
- **Fix erreur de r√©cup√©ration des membres de room**
  - Probl√®me: Tentative d'acc√®s √† `member.user.name` causait des erreurs potentielles
  - Solution: Ajout de v√©rification `if member.user` et retour du genre au lieu du nom pour les statistiques
  - Fichier modifi√©: `backend/routes/establishments.py` (lignes 304-331)

- **Fix champ photo_url manquant dans l'API**
  - Probl√®me: La r√©ponse de `/api/establishments/me` ne retournait pas le `photo_url`
  - Solution: Ajout du champ `photo_url` dans la r√©ponse JSON
  - Fichier modifi√©: `backend/routes/establishments.py` (ligne 155)

- **Fix conflit de noms de fonction JavaScript**
  - Probl√®me: Deux fonctions nomm√©es `updateProfile()` causaient des conflits
  - Solution: Renommage de la fonction d'affichage en `updateProfileDisplay()`
  - Fichier modifi√©: `static/pages/establishment.html` (lignes 511, 445, 1048)

### ‚úÖ V√©rifications
- **Syst√®me de param√®tres du profil √©tablissement**
  - ‚úÖ Modal fonctionnel permettant de modifier nom, description et photo
  - ‚úÖ Photo t√©l√©charg√©e devient la photo par d√©faut pour toutes les rooms cr√©√©es
  - ‚úÖ Bouton "‚öôÔ∏è Param√®tres du profil" accessible dans l'onglet Profil

- **Limites de forfaits √©tablissements**
  - ‚úÖ **One-Shot**: 1 room/jour avec message si limite atteinte + option d'achat
  - ‚úÖ **Silver**: 3 rooms/semaine (cycle de 7 jours) avec compteur et jours restants
  - ‚úÖ **Gold**: 7 rooms/semaine (cycle de 7 jours) avec compteur et jours restants
  - ‚úÖ **Aucun forfait**: Message invitant √† acheter un forfait
  - ‚úÖ **Limite atteinte**: Option d'acheter un One-Shot accessible directement dans le profil

### üìã Fichiers Modifi√©s
- `backend/routes/establishments.py` - Corrections API membres et photo_url
- `static/pages/establishment.html` - Correction conflit fonction JavaScript

### üì¶ Commandes de D√©ploiement VPS

#### Mise √† jour du code depuis GitHub
```bash
# Se connecter au VPS via SSH
ssh user@votre-serveur.com

# Aller dans le r√©pertoire du projet
cd /chemin/vers/matchspot

# Sauvegarder la configuration actuelle
cp .env .env.backup

# R√©cup√©rer les derni√®res modifications
git pull origin main

# Installer/mettre √† jour les d√©pendances si n√©cessaire
pip install -r requirements.txt
```

#### Migration de la base de donn√©es
```bash
# Si vous utilisez Flask-Migrate (recommand√©)
flask db upgrade

# OU si migration manuelle n√©cessaire
# Connectez-vous √† PostgreSQL et ex√©cutez les requ√™tes SQL n√©cessaires
psql $DATABASE_URL

# Red√©marrer l'application
sudo systemctl restart matchspot
# OU si vous utilisez gunicorn directement
pkill -HUP gunicorn
```

#### V√©rification apr√®s d√©ploiement
```bash
# V√©rifier les logs
tail -f /var/log/matchspot/error.log

# V√©rifier que l'application r√©pond
curl http://localhost:5000/

# V√©rifier le statut du service
sudo systemctl status matchspot
```

---

## [10 Octobre 2025 - 23:00 UTC] - D√©placement Carrousel Profils vers Landing Page

### üë• Section Profils Inscrits - Landing Page
- **D√©placement du carrousel du dashboard vers la landing page**
  - Section ajout√©e apr√®s "Comment √ßa marche" et avant "Plans d'adh√©sion"
  - Titre: "üë• Ils sont d√©j√† inscrits"
  - Description: "Rejoignez une communaut√© diverse et authentique"
  - 6 profils avec photos r√©elles diversifi√©es (Sophie, Malik, Emma, Yuki, Carlos, Amara)
  - Photos g√©n√©r√©es et stock√©es dans `static/images/profiles/`
  - Animation scroll infini (40s) avec duplication des profils
  - Design: cartes 140px avec photos 128x128px arrondies, overlay gradient pour noms/√¢ges
  - Call-to-action: "Rejoignez-nous maintenant üöÄ"

### üóëÔ∏è Nettoyage Dashboard Utilisateur
- **Retrait du carrousel du dashboard app**
  - Carrousel retir√© de `static/pages/app.html` 
  - Fonction JavaScript `initProfileCarousel()` supprim√©e
  - Focus du dashboard sur les fonctionnalit√©s utilisateur (rooms, messages)

### üìã Fichiers Modifi√©s
- `static/pages/index.html` - Ajout section profils avec carrousel + JS
- `static/pages/app.html` - Retrait carrousel et code JS associ√©
- `static/images/profiles/` - 6 nouvelles photos de profils diversifi√©s
- `CHANGELOG.md` - Documentation

### ‚úÖ Tests
- ‚úÖ Application red√©marr√©e avec succ√®s
- ‚úÖ Landing page affiche le carrousel correctement
- ‚úÖ Animation infinie fonctionne
- ‚úÖ Dashboard utilisateur nettoy√©

---

## [10 Octobre 2025 - 22:52 UTC] - Am√©liorations UX et Corrections

### üîß Correction Toggle Consentement Photos
- **Ajout de la route manquante `/api/profile/photo-consent`**
  - Endpoint POST pour activer/d√©sactiver le consentement photos
  - Toggle fonctionnel qui inverse l'√©tat actuel (`photo_consent_enabled`)
  - Par d√©faut: OFF (d√©j√† configur√© dans le mod√®le User)
  - Fichier modifi√©: `backend/routes/profile.py` (lignes 138-147)

### üé® Logo Mode Sombre
- **Ajout du logo sp√©cifique pour le mode dark**
  - Nouveau logo avec texte blanc pour meilleure visibilit√© en mode sombre
  - Fichier ajout√©: `static/images/logo-dark.png`
  - CSS pour affichage/masquage automatique selon le th√®me actif
  - Fichiers modifi√©s: `static/pages/app.html` (lignes 56-58, 88-89)

### ‚è≥ Ic√¥ne V√©rification En Attente
- **Remplacement de l'ic√¥ne orange par un sablier**
  - Les utilisateurs avec v√©rification "pending" affichent maintenant ‚è≥ au lieu d'un badge orange
  - Badge gris avec emoji sablier pour meilleure compr√©hension visuelle
  - Fichier modifi√©: `static/pages/app.html` (lignes 722-727)

### üì± Correction Popup PWA Install
- **R√©apparition du popup apr√®s 7 jours**
  - Ancien syst√®me: popup ne s'affichait plus jamais apr√®s dismiss
  - Nouveau syst√®me: utilise `pwa_install_dismissed_date` avec v√©rification de 7 jours
  - Le popup r√©appara√Æt si dernier dismiss > 7 jours ou jamais dismissed
  - Fichiers modifi√©s: `static/pages/app.html` (lignes 2456-2468, 2482-2484)

### üë• Carrousel Profils Dashboard
- **Ajout d'un carrousel infini de profils al√©atoires**
  - Section "‚ú® Profils d√©j√† inscrits" dans le dashboard
  - 10 profils avec noms diversifi√©s (Sophie, Malik, Emma, Yuki, Carlos, Amara, Liam, Priya, Ahmed, Zoe)
  - Animation scroll infini avec boucle continue (30s)
  - Avatars color√©s avec d√©grad√©s vari√©s repr√©sentant diff√©rentes ethnicit√©s
  - Fichiers modifi√©s: 
    - `static/pages/app.html` (lignes 60-64 pour CSS, 120-126 pour HTML, 2603-2631 pour JS)

### üìã Fichiers Modifi√©s
- `backend/routes/profile.py` - Ajout route photo-consent
- `static/pages/app.html` - Logo dark, ic√¥ne sablier, popup PWA, carrousel
- `static/images/logo-dark.png` - Nouveau logo mode sombre

### ‚úÖ Tests
- ‚úÖ Application red√©marr√©e avec succ√®s
- ‚úÖ Toutes les modifications charg√©es sans erreur
- ‚úÖ Workflow "Start application" en cours d'ex√©cution

---

## [10 Octobre 2025 - 22:20 UTC] - Mise √† Jour Favicon + Documentation

### üé® Nouveau Favicon (uniquement)
- **Nouveau favicon multicolore pour l'ic√¥ne du navigateur**
  - Favicon avec d√©grad√© moderne : bleu, violet, rose, vert
  - Design c≈ìur central blanc avec bords color√©s
  - Fichier mis √† jour : `static/images/favicon.png`
  - Toutes les tailles d'ic√¥nes PWA mises √† jour (72, 96, 128, 144, 152, 192, 384, 512px)
  - **Le logo principal (landing page + dashboard) reste inchang√©** : logo original MatchSpot

### üìö Consolidation Documentation
- **Simplification des guides de d√©ploiement**
  - Suppression du fichier redondant `DEPLOIEMENT_EXTERNE.md`
  - Enrichissement de `DEPLOYMENT_VPS.md` comme guide unique de d√©ploiement externe
  - Titre mis √† jour : "D√©ploiement Externe (VPS, Cloud, Serveur D√©di√©)"
  - Ajout de la section "Portabilit√© des Secrets" avec avertissements critiques
  - Documentation mise √† jour dans `replit.md` pour pointer vers les bons fichiers

---

## [10 Octobre 2025 - 22:00 UTC] - Portabilit√© et D√©ploiement Externe

### üîß Configuration Am√©lior√©e
- **Support SECRET_KEY pour d√©ploiement externe**
  - L'application utilise maintenant `SECRET_KEY` comme variable principale
  - Fallback automatique vers `SESSION_SECRET` pour compatibilit√© Replit
  - Permet le d√©ploiement en dehors de Replit sans erreurs
  - Fichier modifi√©: `backend/__init__.py` (ligne 55)

### üìö Documentation de D√©ploiement
- **Guide de d√©ploiement externe am√©lior√©**
  - Fichier `DEPLOYMENT_VPS.md` enrichi avec instructions de portabilit√©
  - Explique comment r√©cup√©rer et utiliser les m√™mes secrets depuis Replit
  - Guide de migration de base de donn√©es avec pg_dump/restore
  - Instructions pour VPS, Cloud, et Serveur D√©di√©
  - ‚ö†Ô∏è Avertissements critiques sur l'importance d'ENCRYPTION_KEY identique

- **Script de v√©rification de configuration**
  - Nouveau fichier: `verify_config.py` pour valider l'environnement
  - V√©rifie toutes les variables requises (SECRET_KEY/SESSION_SECRET, ENCRYPTION_KEY, DATABASE_URL)
  - Indique les variables manquantes et leur criticit√©
  - Commande: `python verify_config.py`

- **Am√©lioration .env.example**
  - Ajout de notes explicatives sur SECRET_KEY vs SESSION_SECRET
  - Clarification sur l'importance critique d'ENCRYPTION_KEY identique
  - Warnings visuels pour attirer l'attention sur les points critiques
  - Fichier modifi√©: `.env.example`

### üìñ Documentation Projet
- **Mise √† jour replit.md**
  - Section d√©di√©e "D√©ploiement Externe (Hors Replit)"
  - Instructions claires pour la portabilit√© des secrets
  - Liens vers les nouveaux guides de d√©ploiement
  - Avertissements sur ENCRYPTION_KEY et donn√©es chiffr√©es
  - Fichier modifi√©: `replit.md` (lignes 68-95)

### ‚úÖ R√©sultats
- ‚úÖ L'application fonctionne identiquement sur Replit et en externe
- ‚úÖ Les m√™mes secrets permettent d'acc√©der aux m√™mes donn√©es chiffr√©es
- ‚úÖ Migration de donn√©es facilit√©e avec documentation compl√®te
- ‚úÖ Validation de configuration automatis√©e
- ‚úÖ Compatible avec tous les h√©bergeurs (PythonAnywhere, Railway, VPS, etc.)

---

## [10 Octobre 2025 - 18:00 UTC] - Nouveau design avec logo multicolore

### ‚úçÔ∏è Contenu et Messages
- **Refonte du message principal du hero**
  - Nouveau titre: "Vos lieux. Vos matchs. Pas du swipe"
  - Nouveau sous-titre: "Chaque lieu devient une opportunit√© de rencontre authentique."
  - Message plus percutant et concis qui diff√©rencie clairement la plateforme

### üéØ Interface Utilisateur
- **Dashboard utilisateur am√©lior√©**
  - Ajout du logo multicolore avant le titre "Accueil"
  - Barre verticale comme s√©parateur entre le logo et le texte
  - Am√©lioration visuelle de l'en-t√™te du dashboard

### üé® Design et Identit√© visuelle
- **Nouveau logo et favicon multicolore**
  - Logo avec d√©grad√© vibrant : rose, violet, bleu cyan, vert turquoise
  - Favicon mis √† jour sur toutes les pages
  - Fichiers ajout√©s: `static/images/logo.png`, `static/images/favicon.png`

- **Nouvelle palette de couleurs**
  - Rose principal: #FF4081 (remplace #FF4458)
  - Violet: #5B4DFF (remplace #6C5CE7)
  - Bleu cyan: #00D4FF (remplace #A29BFE)
  - Vert turquoise: #00E5A0
  - D√©grad√©s enrichis avec 3+ couleurs pour plus de profondeur

- **Mise √† jour de toutes les pages**
  - index.html: Hero avec d√©grad√© from-[#FF4081] via-[#5B4DFF] to-[#00D4FF]
  - app.html: Logo dans l'invite d'installation PWA
  - establishment.html: Couleurs adapt√©es
  - admin.html: Couleurs adapt√©es
  - manifest.json: theme_color mis √† jour

---

## [10 Octobre 2025 - 17:30 UTC] - Am√©liorations UI et QR Code

### üé® Am√©liorations UI
- **Repositionnement de l'indicateur de notification**
  - L'indicateur de messages non lus (point rouge) a √©t√© d√©plac√© du coin de la photo de profil vers le c√¥t√© droit de la ligne de message
  - Design plus √©pur√© et professionnel
  - Fichier modifi√©: `static/pages/app.html` (lignes 1368-1390)

### üì± QR Code √âtablissements
- **Am√©lioration de la mise en page du QR code t√©l√©chargeable**
  - Ajout d'une ligne horizontale s√©paratrice au-dessus du texte d'instructions
  - Le site web www.thematchspot.com est maintenant affich√© en dessous du texte "pour rejoindre cette room"
  - Design plus structur√© et professionnel
  - **R√©solution augment√©e x4** (1600x2000 pixels) pour une qualit√© d'impression professionnelle
  - Fichier modifi√©: `static/pages/establishment.html` (lignes 658-705)

---

## [10 Octobre 2025 - 17:03 UTC] - Mise √† jour compl√®te des tarifs d'abonnement

### üí∞ Changements tarifaires
- **Plans Utilisateurs**
  - Free: $0/mois - Conservation conversations 24h (inchang√©)
  - Premium: $19 ‚Üí $4.99/mois - Conservation 7 jours + filtres + identit√© alternative
  - Platinum: $39 ‚Üí $9.99/mois - Conservation 30 jours + filtres + visibilit√© prioritaire + identit√© alternative

- **Plans √âtablissements**
  - Single Shot: $9 ‚Üí $19 CAD - 1 code (24h)
  - Silver: $49 CAD - 3 codes/semaine (limite quotidienne: 1/jour)
  - Gold: $99 CAD - 7 codes/semaine (1 code/jour)

### üîß Am√©liorations techniques
- **Suppression des valeurs hardcod√©es**
  - Les limites de cr√©ation de rooms proviennent maintenant de la base de donn√©es (SubscriptionPlan.rooms_per_day)
  - Fichier modifi√©: `backend/routes/establishments.py` (lignes 58-63, 144-149)
  - Les valeurs ne sont plus en dur dans le code, facilitant les changements futurs

- **Mise √† jour de l'initialisation**
  - Fichier modifi√©: `backend/__init__.py` (lignes 96-98, 107-109)
  - Les nouveaux environnements utilisent automatiquement les tarifs corrects
  - Base de donn√©es existantes mises √† jour via SQL

### üìù Notes techniques
- Le syst√®me actuel suit les limites quotidiennes pour les √©tablissements
- Plans hebdomadaires (Silver: 3/semaine, Gold: 7/semaine) limit√©s √† 1/jour actuellement
- Une future am√©lioration pourrait impl√©menter un vrai suivi hebdomadaire

---

## [10 Octobre 2025 - 16:54 UTC] - Fix endpoint √©tablissements

### üêõ Corrections de bugs
- **Fix erreur 403 sur changement de forfait (√©tablissements)**
  - Probl√®me: Les √©tablissements utilisaient l'endpoint admin `/api/admin/plans` qui n√©cessite des droits administrateur
  - Solution: Changement vers l'endpoint public `/api/subscriptions/plans` accessible aux √©tablissements
  - Fichier modifi√©: `static/pages/establishment.html` (ligne 817)
  - Erreur corrig√©e: `GET /api/admin/plans 403 (FORBIDDEN)`

---

## [10 Octobre 2025] - Syst√®me de notifications et param√®tres de messages

### üéØ Fonctionnalit√©s ajout√©es
- **Syst√®me de notifications pour messages non lus**
  - Badge rouge avec compteur sur chaque conversation contenant des messages non lus
  - Badge de notification sur l'onglet Messages dans le menu de navigation
  - Le compteur dispara√Æt automatiquement quand les messages sont lus
  - Fichiers modifi√©s: 
    - `backend/models/private_conversation.py` (ajout de `unread_count`)
    - `static/pages/app.html` (affichage des badges et notifications)

### üîß Am√©liorations
- **Param√®tre "Recevoir des photos" d√©sactiv√© par d√©faut**
  - Pour plus de confidentialit√©, le toggle est maintenant OFF par d√©faut pour les nouveaux utilisateurs
  - Les utilisateurs doivent explicitement l'activer pour recevoir des photos
  - Fichier modifi√©: `backend/models/user.py` (ligne 45: `default=False`)

---

## [10 Octobre 2025] - Corrections critiques

### üêõ Corrections de bugs
- **Fix du chargement infini des participants dans les rooms**
  - Probl√®me: L'auto-refresh v√©rifiait le mauvais √©l√©ment DOM (`participantsList` au lieu de `participantsModal`)
  - Solution: Correction de la v√©rification pour utiliser `participantsModal` dans `startAutoRefresh()`
  - Fichier: `static/pages/app.html` ligne 2449

- **Fix de la gestion d'erreur pour les plans d'abonnement**
  - Probl√®me: Pas de v√©rification du statut de la r√©ponse HTTP lors du chargement des plans
  - Solution: Ajout de v√©rification `if (!plansRes.ok || !requestsRes.ok)` avant le traitement des donn√©es
  - Fichier: `static/pages/app.html` ligne 1941-1943

### üîê S√©curit√©
- **Ajout des cl√©s secr√®tes manquantes**
  - Ajout de `SECRET_KEY` dans les secrets Replit pour la s√©curit√© des sessions Flask
  - Ajout de `ENCRYPTION_KEY` dans les secrets Replit pour le chiffrement des donn√©es sensibles
  - Ces cl√©s sont maintenant disponibles comme variables d'environnement

### üì¶ D√©ploiement
- **Configuration du d√©ploiement Replit**
  - Type: Autoscale (pour sites web stateless)
  - Commande: `gunicorn --bind 0.0.0.0:5000 main:app`
  - Les secrets sont synchronis√©s entre l'environnement de d√©veloppement et le d√©ploiement

### üìù Documentation
- **Cr√©ation du fichier CHANGELOG.md**
  - Documentation de toutes les modifications et corrections
  - Instructions pour maintenir ce fichier √† jour
  
- **Mise √† jour de replit.md**
  - Ajout de l'instruction de toujours mettre √† jour CHANGELOG.md
  - Documentation des secrets requis

---

## Template pour futures modifications

```markdown
## [DATE] - Titre de la modification

### üéØ Fonctionnalit√©s ajout√©es
- Description de la nouvelle fonctionnalit√©
- Fichiers modifi√©s: `chemin/vers/fichier.py`

### üêõ Corrections de bugs
- Description du bug corrig√©
- Fichiers modifi√©s: `chemin/vers/fichier.py`

### üîß Am√©liorations
- Description de l'am√©lioration
- Fichiers modifi√©s: `chemin/vers/fichier.py`

### üîê S√©curit√©
- Description de la modification de s√©curit√©
- Fichiers modifi√©s: `chemin/vers/fichier.py`
```

---

## L√©gende des emojis
- üéØ Nouvelle fonctionnalit√©
- üêõ Correction de bug
- üîß Am√©lioration/Optimisation
- üîê S√©curit√©
- üì¶ D√©ploiement
- üìù Documentation
- ‚ö†Ô∏è Avertissement/D√©pr√©ciation
- üóëÔ∏è Suppression
